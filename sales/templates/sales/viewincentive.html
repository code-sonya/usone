{% extends "dashboard/layout.html" %}{% load humanize %}{% block title %}  인센티브현황{% endblock %}{% block css %}  <style type="text/css">    .pc-table {      color: #333333;      table-layout: fixed;      width: 100%;      border-collapse: collapse;      margin-bottom: 1rem;    }    .pc-table td, .pc-table th {      padding: 5px 15px;      text-align: center;      vertical-align: middle;      font-size: 17px;      border-top: 1px dotted #858796a3;    }    .pc-table-main {      color: #333333;      table-layout: fixed;      width: 100%;      border-collapse: collapse;      margin-bottom: 1rem;    }    .pc-table-main td, .pc-table-main th {      padding: 5px;      text-align: center;      vertical-align: middle;      font-size: 18px;      border-top: 1px dotted #858796a3;    }    .mobile-table {      color: #333333;      width: 100%;      border-collapse: collapse;      margin-bottom: 1rem;    }    .mobile-table td, .mobile-table th {      padding: 5px 10px;      text-align: center;      vertical-align: middle;      font-size: 14px;      border-top: 1px dotted #858796a3;    }    .thtd {      text-align: center;      border: 1px solid lightgray;      border-collapse: collapse;    }  </style>{% endblock %}{% block content %}  <div class="d-xl-block">    <div class="card shadow mb-4">      <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">        <h3 class="m-0 text-gray-800"> {{ empName }}님의 인센티브 현황 </h3>      </div>      <div class="card-body">        {#언제쓸지 몰라 숨겨놓음#}        <h5 class="text-dark mb-3 d-none"><b>▼ SALARY</b></h5>        <table class="pc-table d-none">          <thead>          <tr class="bg-primary">            <td class="text-gray-100" colspan="3">항목</td>            <td class="text-gray-100" colspan="2">1분기</td>            <td class="text-gray-100" colspan="2">2분기</td>            <td class="text-gray-100" colspan="2">3분기</td>            <td class="text-gray-100" colspan="2">4분기</td>          </tr>          </thead>          <tbody>          {% for t1 in table1 %}            <tr>              <td colspan="3">{{ t1.name }}</td>              <td class="text-right pr-4" colspan="2">{{ t1.q1 | intcomma }}</td>              <td class="text-right pr-4" colspan="2">{{ t1.q2 | intcomma }}</td>              <td class="text-right pr-4" colspan="2">{{ t1.q3 | intcomma }}</td>              <td class="text-right pr-4" colspan="2">{{ t1.q4 | intcomma }}</td>            </tr>          {% endfor %}          </tbody>        </table>        <h5 class="text-dark mb-3"><b>▼ 누적 인센티브 확정 금액</b></h5>        <table class="pc-table">          <thead>          <tr class="bg-info text-white">            <td>인센티브</td>            <td>AWARD</td>          </tr>          </thead>          <tbody>          <tr>            <td><h1 id="incentivemoney" class="money">{% if sumachieveIncentive.achieveIncentive__sum == 0 %}-{% endif %}</h1></td>            <td><h1 id="awardmoney" class="money">{% if sumachieveAward.achieveAward__sum == 0 %}-{% endif %}</h1></td>          </tr>          </tbody>        </table>        <!--<div width="100%" class="text-center"><h1 id="incentivemoney"></h1></span></div>-->        <h5 class="text-dark mb-3"><b>▼ 인센티브 금액</b></h5>        <table class="pc-table">          <thead>          <tr class="bg-secondary">            <td class="text-gray-100" colspan="3">항목</td>            <td class="text-gray-100" colspan="2">1분기</td>            <td class="text-gray-100" colspan="2">2분기</td>            <td class="text-gray-100" colspan="2">3분기</td>            <td class="text-gray-100" colspan="2">4분기</td>          </tr>          </thead>          <tbody>          {% for t3 in table3 %}            <tr>              <td colspan="3">{{ t3.name }}</td>              <td class="text-right pr-4" colspan="2">{{ t3.q1 | intcomma }}</td>              <td class="text-right pr-4" colspan="2">{{ t3.q2 | intcomma }}</td>              <td class="text-right pr-4" colspan="2">{{ t3.q3 | intcomma }}</td>              <td class="text-right pr-4" colspan="2">{{ t3.q4 | intcomma }}</td>            </tr>          {% endfor %}          </tbody>        </table>        <br>        <h5 class="text-dark mb-3"><b>▼ 분기별 팀 실적</b></h5>        <table class="pc-table">          <thead>          <tr class="bg-secondary">            <td class="text-gray-100" colspan="2"></td>            <td class="text-gray-100"></td>            <td class="text-gray-100" colspan="2">1분기</td>            <td class="text-gray-100" colspan="2">2분기</td>            <td class="text-gray-100" colspan="2">3분기</td>            <td class="text-gray-100" colspan="2">4분기</td>          </tr>          </thead>          <tbody>          <tr class="thtd">            <td rowspan="2" colspan="2">목표(팀)</td>            <td>매출<br>(누적)</td>            <td colspan="2" class="text-right pr-4">              {{ table2.target.revenue.q1 | intcomma }} <br>              ({{ table2.target.cumulation.revenue.q1 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.target.revenue.q2 | intcomma }} <br>              ({{ table2.target.cumulation.revenue.q2 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.target.revenue.q3 | intcomma }} <br>              ({{ table2.target.cumulation.revenue.q3 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.target.revenue.q4 | intcomma }} <br>              ({{ table2.target.cumulation.revenue.q4 | intcomma }})            </td>          </tr>          <tr class="thtd">            <td>GP<br>(누적)</td>            <td colspan="2" class="text-right pr-4">              {{ table2.target.profit.q1 | intcomma }} <br>              ({{ table2.target.cumulation.profit.q1 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.target.profit.q2 | intcomma }} <br>              ({{ table2.target.cumulation.profit.q2 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.target.profit.q3 | intcomma }} <br>              ({{ table2.target.cumulation.profit.q3 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.target.profit.q4 | intcomma }} <br>              ({{ table2.target.cumulation.profit.q4 | intcomma }})            </td>          </tr>          <tr class="thtd">            <td rowspan="2" colspan="2">회의실적(팀)</td>            <td>매출<br>(누적)</td>            <td colspan="2" class="text-right pr-4">              {{ table2.real.revenue.q1 | intcomma }} <br>              ({{ table2.real.cumulation.revenue.q1 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.real.revenue.q2 | intcomma }} <br>              ({{ table2.real.cumulation.revenue.q2 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.real.revenue.q3 | intcomma }} <br>              ({{ table2.real.cumulation.revenue.q3 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.real.revenue.q4 | intcomma }} <br>              ({{ table2.real.cumulation.revenue.q4 | intcomma }})            </td>          </tr>          <tr class="thtd">            <td>GP</td>            <td colspan="2" class="text-right pr-4">              {{ table2.real.profit.q1 | intcomma }} <br>              ({{ table2.real.cumulation.profit.q1 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.real.profit.q2 | intcomma }} <br>              ({{ table2.real.cumulation.profit.q2 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.real.profit.q3 | intcomma }} <br>              ({{ table2.real.cumulation.profit.q3 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.real.profit.q4 | intcomma }} <br>              ({{ table2.real.cumulation.profit.q4 | intcomma }})            </td>          </tr>          <tr class="thtd">            <td rowspan="2" colspan="2"><span class="text-info"><b>인센티브</b></span>실적(팀)</td>            <td>매출<br>(누적)</td>            <td colspan="2" class="text-right pr-4">              {{ table2.incentive.revenue.q1 | intcomma }} <br>              ({{ table2.incentive.cumulation.revenue.q1 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.incentive.revenue.q2 | intcomma }} <br>              ({{ table2.incentive.cumulation.revenue.q2 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.incentive.revenue.q3 | intcomma }} <br>              ({{ table2.incentive.cumulation.revenue.q3 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.incentive.revenue.q4 | intcomma }} <br>              ({{ table2.incentive.cumulation.revenue.q4 | intcomma }})            </td>          </tr>          <tr class="thtd">            <td>GP<br>(누적)</td>            <td colspan="2" class="text-right pr-4">              {{ table2.incentive.profit.q1 | intcomma }} <br>              ({{ table2.incentive.cumulation.profit.q1 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.incentive.profit.q2 | intcomma }} <br>              ({{ table2.incentive.cumulation.profit.q2 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.incentive.profit.q3 | intcomma }} <br>              ({{ table2.incentive.cumulation.profit.q3 | intcomma }})            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.incentive.profit.q4 | intcomma }} <br>              ({{ table2.incentive.cumulation.profit.q4 | intcomma }})            </td>          </tr>          <tr class="thtd">            <td rowspan="3" colspan="2"><span class="text-danger"><b>목표</b></span>달성률(팀)</td>            <td>매출<br>(누적)</td>            <td colspan="2" class="text-right pr-4">              {{ table2.achieve.revenue.q1 | intcomma }}% <br>              ({{ table2.achieve.cumulation.revenue.q1 | intcomma }}%)            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.achieve.revenue.q2 | intcomma }}% <br>              ({{ table2.achieve.cumulation.revenue.q2 | intcomma }}%)            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.achieve.revenue.q3 | intcomma }}% <br>              ({{ table2.achieve.cumulation.revenue.q3 | intcomma }}%)            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.achieve.revenue.q4 | intcomma }}% <br>              ({{ table2.achieve.cumulation.revenue.q4 | intcomma }}%)            </td>          </tr>          <tr class="thtd">            <td>GP<br>(누적)</td>            <td colspan="2" class="text-right pr-4">              {{ table2.achieve.profit.q1 | intcomma }}% <br>              ({{ table2.achieve.cumulation.profit.q1 | intcomma }}%)            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.achieve.profit.q2 | intcomma }}% <br>              ({{ table2.achieve.cumulation.profit.q2 | intcomma }}%)            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.achieve.profit.q3 | intcomma }}% <br>              ({{ table2.achieve.cumulation.profit.q3 | intcomma }}%)            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.achieve.profit.q4 | intcomma }}% <br>              ({{ table2.achieve.cumulation.profit.q4 | intcomma }}%)            </td>          </tr>          <tr class="thtd">            <td>종합<br>(누적)</td>            <td colspan="2" class="text-right pr-4">              {{ table2.achieve.total.q1 | intcomma }}% <br>              ({{ table2.achieve.cumulation.total.q1 | intcomma }}%)            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.achieve.total.q2 | intcomma }}% <br>              ({{ table2.achieve.cumulation.total.q2 | intcomma }}%)            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.achieve.total.q3 | intcomma }}% <br>              ({{ table2.achieve.cumulation.total.q3 | intcomma }}%)            </td>            <td colspan="2" class="text-right pr-4">              {{ table2.achieve.total.q4 | intcomma }}% <br>              ({{ table2.achieve.cumulation.total.q4 | intcomma }}%)            </td>          </tr>          </tbody>        </table>        <br>        <h5 class="text-dark mb-3"><b>▼ AWARD 금액</b></h5>        <div class="mb-1">※ 누적 분기 <span class="text-info">인센티브</span> 실적 달성률 <span class="text-danger">80% 이상</span>시 청구 가능</div>        <table class="pc-table">          <thead>          <tr class="bg-secondary text-white">            <td colspan="2">프로그램</td>            <td colspan="2">지급조건</td>            <td>대상</td>            <td colspan="4">연간</td>          </tr>          <tr class="thtd">            <td colspan="2">GP achieve Bonus</td>            <td colspan="2">연간 GP 목표 달성 시</td>            <td>팀장</td>            <td colspan="4">{{ GPachieve | intcomma }}</td>          </tr>          <tr class="bg-info text-gray-100">            <td colspan="2">프로그램</td>            <td colspan="2">지급조건</td>            <td>대상</td>            <td>1분기</td>            <td>2분기</td>            <td>3분기</td>            <td>4분기</td>          </tr>          </thead>          <tbody>          {% for table in table4 %}            {% if table.name == '합계' or table.name == '' %}              <tr class="thtd bg-light" id="{{ table.id }}">                {% elif table.name == '제약조건' %}              <tr class="thtd" style="background-color: #fffff0" id="{{ table.id }}">                {% else %}              <tr class="thtd" id="{{ table.id }}">            {% endif %}          {% if table.id == 'new' and newCount != '' %}            <td colspan="2">              <div><i class="fas fa-plus-circle" id="i-new"></i> {{ table.name }}</div>            </td>          {% elif table.id == 'over' and overGp != '' %}            <td colspan="2">              <div><i class="fas fa-plus-circle" id="i-over"></i> {{ table.name }}</div>            </td>          {% else %}            <td colspan="2">{{ table.name }}</td>          {% endif %}          <td colspan="2">{{ table.condition }}</td>          <td>{{ table.for }}</td>          {% if table.q1 == 0 or table2.achieve.total.q1 >= 80 or table.q1 == 'X' or table.id == 'expect' or table.id == 'acheive' %}            <td>{{ table.q1 | intcomma }}</td>          {% else %}            <td style="text-decoration:line-through">{{ table.q1 | intcomma }}</td>          {% endif %}          <td>{{ table.q2 | intcomma }}</td>          <td>{{ table.q3 | intcomma }}</td>          <td>{{ table.q4 | intcomma }}</td>          </tr>          {% endfor %}          </tbody>        </table>        <br>        <h5 class="text-dark mb-3"><b>▼ 인센티브 실적 상세 내역</b></h5>        <table class="pc-table">          <thead>          <tr class="thtd bg-secondary text-white">            <td>계약코드</td>            <td colspan="2">계약명</td>            <td>매출일</td>            <td>사유</td>            <td>회의매출실적</td>            <td>인센티브매출실적</td>            <td>회의이익실적</td>            <td>인센티브이익실적</td>          </tr>          </thead>          <tbody>          {% for incentive in incentiveRevenues %}            <tr class="thtd">            <td>{{ incentive.contractId.contractCode }}</td>            <td colspan="2">{{ incentive.contractId }}</td>            <td>{{ incentive.billingDate }}</td>            <td></td>            <td>{{ incentive.revenuePrice }}</td>            <td>{{ incentive.incentivePrice }}</td>            <td>{{ incentive.revenueProfitPrice }}</td>            <td>{{ incentive.incentiveProfitPrice }}</td>            </tr>          {% endfor %}          </tbody>        </table>      </div>    </div>  </div>{% endblock %}{% block script %}  <script type="text/javascript">      $(document).ready(function () {          $(".newtr").hide();          $(".overtr").hide();      });      function animateNumber(ele, no, stepTime) {          var regexp = /\B(?=(\d{3})+(?!\d))/g;          $({someValue: 0}).animate({someValue: no}, {              duration: stepTime,              step: function () {                  ele.text(Math.floor(this.someValue + 1).toString().replace(regexp, ','));              },              complete: function () {                  ele.text(no.toString().replace(regexp, ','));              }          });      }      const incentive = parseInt('{{ sumachieveIncentive.achieveIncentive__sum }}');      const award = parseInt('{{ sumachieveAward.achieveAward__sum }}');      if (incentive > 0) {          animateNumber($('#incentivemoney'), incentive, 1000);      }      if (award > 0) {          animateNumber($('#awardmoney'), award, 1000);      }      let companyName;      let contractId;      let billingDate;      let profitRatio;      {% if newCount|length > 0 %}          const newcount = $("#new");          {% for newC in newCount %}              {% for n in newC %}                  companyName = '{{ n.revenueCompany }}';                  contractId = '{{ n.contractId}}';                  billingDate = '{{ n.billingDate }}';                  profitRatio = '{{ n.contractId.profitRatio }}';                  newcount.after('<tr class="newtr" style="background-color: #ebfbff;"><td colspan="2"></td><td colspan="2">' + companyName + '</td><td><a href="/sales/viewcontract/{{ n.contractId.contractId }}/">' +                      contractId + '</a></td><td colspan="2">' + billingDate + '</td><td colspan="2">' + profitRatio + '%</td></tr>');              {% endfor %}          {% endfor %}      {% endif %}      {% if overGp|length > 0 %}          const overgp = $("#over");          {% for overg in overGp %}              {% for o in overg %}                  companyName = '{{ o.revenueCompany }}';                  contractId = '{{ o.contractId}}';                  billingDate = '{{ o.billingDate }}';                  profitRatio = '{{ o.contractId.profitRatio }}';                  overgp.after('<tr class="overtr" style="background-color: #ebfbff;"><td colspan="2"></td><td colspan="2">' + companyName + '</td><td colspan="3"><a href="/sales/viewcontract/{{ o.contractId.contractId }}/">' +                      contractId + '</a></td><td>' + billingDate + '</td><td>' + profitRatio + '%</td></tr>');              {% endfor %}          {% endfor %}      {% endif %}      $('#i-new').click(function () {          $(".newtr").show();          $("#i-new").hide();      });      $('#i-over').click(function () {          $(".overtr").show();          $("#i-over").hide();      });  </script>{% endblock %}
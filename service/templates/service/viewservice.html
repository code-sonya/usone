{% extends "dashboard/layout.html" %}


{% block title %}
  일정관리
{% endblock %}


{% block css %}

  <style type="text/css">
    .form-control[readonly] {
      background-color: white;
      font-weight: bold;
    }
  </style>

{% endblock %}


{% block content %}

  <div class="row">
    <div class="col-xl-2"></div>

    <!-- PC화면, 일정 완료 전 -->
    <div class="col-xl-8 d-none d-xl-block">

      <div class="card shadow mb-4">

        <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">

          <h6 class="m-0 h3 text-gray-800"> 상세내용 </h6>

          <div class="dropdown no-arrow">
            <a class="dropdown-toggle" href="#" role="button" onclick="btn_board()">
              <i class="fas fa-plus fa-fw text-gray-400"></i>
            </a>
          </div>

        </div>

        <div class="card-body">

          {% csrf_token %}
          <div class="form-group row">
            <div class="col-xl-6 mb-3 mb-sm-0">
              <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                      <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">성함</div>
                      <div class="h5 mb-0 font-weight-bold text-gray-800" id="empName">{{ service.empName }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-6 mb-3 mb-sm-0">
              <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                      <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">직출</div>
                      <div class="h5 mb-0 font-weight-bold text-gray-800" id="directgo">{{ service.directgo }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-xl-6 mb-3 mb-sm-0">
              <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                      <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">고객사</div>
                      <div class="h5 mb-0 font-weight-bold text-gray-800" id="companyName">{{ service.companyName }} ({{ service.serviceLocation }})</div>
                    </div>
                    <div class="col-auto">
                      <a href="{% url 'client:view_client' service.companyName %}"><i class="fas fa-building fa-2x text-gray-300"></i></a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-6 mb-3 mb-sm-0">
              <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                      <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">일정구분</div>
                      <div class="h5 mb-0 font-weight-bold text-gray-800" id="serviceType">{{ service.serviceType }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-xl-6 mb-3 mb-sm-0">
              <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                      <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">시작시간</div>
                      <div class="h5 mb-0 font-weight-bold text-gray-800" id="serviceStartDatetime">
                        {{ service.serviceStartDatetime | date:"Y.m.d(D" | slice:":12"}}) {{ service.serviceStartDatetime | time:"H:i"}}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-6 mb-3 mb-sm-0">
              <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                      <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">종료시간</div>
                      <div class="h5 mb-0 font-weight-bold text-gray-800" id="serviceEndDatetime">
                        {{ service.serviceStartDatetime | date:"Y.m.d(D" | slice:":12"}}) {{ service.serviceEndDatetime | time:"H:i"}}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-xl-6 mb-3 mb-sm-0">
              <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                      <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">소요시간</div>
                      <div class="h5 mb-0 font-weight-bold text-gray-800" id="serviceHour">{{ service.serviceHour }} 시간</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-6 mb-3 mb-sm-0">
              <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                      <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">초과근무</div>
                      <div class="h5 mb-0 font-weight-bold text-gray-800" id="serviceOverHour">{{ service.serviceOverHour }} 시간</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-xl-12 mb-3 mb-sm-0">
              <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                      <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">제목</div>
                      <div class="h5 mb-0 font-weight-bold text-gray-800" id="serviceTitle">{{ service.serviceTitle }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-xl-12 mb-3 mb-sm-0">
              <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                      <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">내용</div>
                      <div class="h5 mb-0 font-weight-bold text-gray-800" id="serviceDetails">{{ service.serviceDetails | linebreaksbr }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          {% if service.empId.empId == user.employee.empId and service.serviceStatus == 'N' %}
            <div class="text-center">
              <a href="#" class="btn btn-danger btn-icon-split" onclick="btn_delete()">
                <span class="icon text-white-50"> <i class="fas fa-trash-alt"> </i> </span>
                <span class="text"> 삭제 </span>
              </a>
              <a href="#" class="btn btn-info btn-icon-split" onclick="btn_modify()">
                <span class="icon text-white-50"> <i class="fas fa-edit"> </i> </span>
                <span class="text"> 수정 </span>
              </a>
              <a href="#" class="btn btn-success btn-icon-split" onclick="btn_save()">
                <span class="icon text-white-50"> <i class="fas fa-check"> </i> </span>
                <span class="text"> 완료 </span>
              </a>
            </div>
          {% elif service.empId.empId != user.employee.empId and service.serviceStatus == 'N' %}
            <div class="text-center">
              <a href="#" class="btn btn-info btn-icon-split" onclick="btn_copy()">
                <span class="icon text-white-50"> <i class="fas fa-copy"> </i> </span>
                <span class="text"> 복사 </span>
              </a>
            </div>
          {% endif %}

        </div>

      </div>

    </div>

    <!-- 모바일 화면, 일정 완료 전 -->
    <div class="col-xl-8 d-block d-xl-none">

      <div class="card shadow mb-4">

        <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">

          <h6 class="m-0 h3 text-gray-800"> 상세내용 </h6>

        </div>

        <div class="card-body ">
          <form id="ServicereportForm">

            {% csrf_token %}
            <div class="form-group row">
              <div class="col-6 mb-3 mb-sm-0">
                <label for="companyName" class="font-weight-bold text-primary"> 고객사 명 </label>
                <input readonly type="text" name="companyName" value="{{ service.companyName }}" class="form-control" id="companyName">
              </div>
              <div class="col-6">
                <label for="serviceType" class="font-weight-bold text-primary"> 일정 구분 </label>
                <input readonly type="text" name="serviceType" value="{{ service.serviceType }}" class="form-control" id="serviceType">
              </div>
            </div>
            <div class="form-group row">
              <div class="col-6 mb-3 mb-sm-0">
                <label for="startdate" class="font-weight-bold text-primary"> 시작 일자 </label>
                <input readonly type="date" name="startdate" value="{{ service.serviceStartDatetime|date:"Y-m-d" }}" class="form-control" id="startdate">
              </div>
              <div class="col-6">
                <label for="starttime" class="font-weight-bold text-primary"> 시작 시간 </label>
                <input readonly type="time" name="starttime" value="{{ service.serviceStartDatetime|time:"H:i" }}" class="form-control" id="starttime">
              </div>
            </div>
            <div class="form-group row">
              <div class="col-6 mb-3 mb-sm-0">
                <label for="enddate" class="font-weight-bold text-primary"> 종료 일자 </label>
                <input readonly type="date" name="enddate" value="{{ service.serviceEndDatetime|date:"Y-m-d" }}" class="form-control" id="enddate">
              </div>
              <div class="col-6">
                <label for="endtime" class="font-weight-bold text-primary"> 종료 시간 </label>
                <input readonly type="time" name="endtime" value="{{ service.serviceEndDatetime|time:"H:i" }}" class="form-control" id="endtime">
              </div>
            </div>
            <div class="form-group row">
              <div class="col-6 mb-3 mb-sm-0">
                <label for="serviceHour" class="font-weight-bold text-primary"> 소요 시간 </label>
                <input readonly type="text" name="serviceHour" value="{{ service.serviceHour }} 시간" class="form-control" id="serviceHour">
              </div>
              <div class="col-6">
                <label for="serviceOverHour" class="font-weight-bold text-primary"> 초과 근무 </label>
                <input readonly type="text" name="serviceOverHour" value="{{ service.serviceOverHour }} 시간" class="form-control" id="serviceOverHour">
              </div>
            </div>
            <div class="form-group row">
              <div class="col-6 mb-3 mb-sm-0">
                <label for="serviceLocation" class="font-weight-bold text-primary"> 지역 구분 </label>
                <input readonly type="text" name="serviceLocation" value="{{ service.serviceLocation }}" class="form-control" id="serviceLocation">
              </div>
              <div class="col-6">
                <label for="directgo" class="font-weight-bold text-primary"> 직출 여부 </label>
                <input readonly type="text" name="directgo" value="{{ service.directgo }}" class="form-control" id="directgo">
              </div>
            </div>
            <div class="form-group">
              <label for="serviceTitle" class="font-weight-bold text-primary"> 제목 </label>
              <input readonly type="text" name="serviceTitle" value="{{ service.serviceTitle }}" class="form-control" id="serviceTitle">
            </div>
            <div class="form-group">
              <label for="serviceDetails" class="font-weight-bold text-primary"> 내용 </label>
              <textarea name="serviceDetails" cols="40" rows="10" class="form-control" id="serviceDetails">{{ service.serviceDetails }}</textarea>
            </div>

          </form>

          {% if service.empId.empId == user.employee.empId and service.serviceStatus == 'N' %}
            <div class="text-center">
              <a href="#" class="btn btn-danger btn-icon-split" onclick="btn_delete()">
                <span class="icon text-white-50"> <i class="fas fa-trash-alt"> </i> </span>
                <span class="text p-2"> 삭제 </span>
              </a>
              <a href="#" class="btn btn-info btn-icon-split" onclick="btn_modify()">
                <span class="icon text-white-50"> <i class="fas fa-edit"> </i> </span>
                <span class="text p-2"> 수정 </span>
              </a>
              <a href="#" class="btn btn-success btn-icon-split" onclick="btn_save()">
                <span class="icon text-white-50"> <i class="fas fa-check"> </i> </span>
                <span class="text p-2"> 완료 </span>
              </a>
            </div>
          {% elif service.empId.empId != user.employee.empId and service.serviceStatus == 'N' %}
            <div class="text-center">
              <a href="#" class="btn btn-info btn-icon-split" onclick="btn_copy()">
                <span class="icon text-white-50"> <i class="fas fa-copy"> </i> </span>
                <span class="text"> 복사 </span>
              </a>
            </div>
          {% endif %}

        </div>

      </div>

    </div>

    <div class="col-xl-2"></div>
  </div>

{% endblock %}


{% block script %}

  <script type="text/javascript">

      function btn_save(){
          if (confirm("일정을 완료 하시겠습니까?") === true) {
              location.href = '/signature/selectmanager/' + {{ service.serviceId }} + '/';
          }
      }

      function btn_modify(){
          if (confirm("일정을 수정 하시겠습니까?") === true) {
              location.href = '/service/modifyservice/' + {{ service.serviceId }} + '/';
          }
      }

      function btn_delete(){
          if (confirm("일정을 삭제 하시겠습니까?") === true) {
              location.href = '/service/deleteservice/' + {{ service.serviceId }} + '/';
          }
      }

      function btn_copy(){
          if (confirm("일정을 복사 하시겠습니까?") === true) {
              location.href = '/service/copyservice/' + {{ service.serviceId }} + '/';
          }
      }

      function btn_board(){
          location.href = '/noticeboard/postboard/' + {{ service.serviceId }} + '/';
      }

  </script>

{% endblock %}
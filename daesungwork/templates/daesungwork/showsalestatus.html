{% extends "dashboard/layout.html" %}


{% block title %}
판매현황
{% endblock %}

{% block css %}
<style>
  pc-table {
    color: #333333;
    table-layout: fixed;
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 1rem;
  }

  .pc-table td, .pc-table th {
    padding: 5px 15px;
    text-align: center;
    vertical-align: middle;
    font-size: 17px;
    border: 1px solid rgba(206, 210, 219, 0.64);
  }

  pc-table2 {
    color: #333333;
    table-layout: fixed;
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 1rem;
  }

  .pc-table2 td, .pc-table th {
    padding: 3px 10px;
    text-align: center;
    vertical-align: middle;
    font-size: 15px;
    border: 1px solid rgba(206, 210, 219, 0.64);
  }

  .file_input_textbox {
    float: left;
    height: 29px;
  }

  .file_input_div {
    position: relative;
    width: 80px;
    height: 36px;
    overflow: hidden;
  }

  .file_input_img_btn {
    padding: 0 0 0 5px;
  }

  .file_input_hidden {
    font-size: 29px;
    position: absolute;
    right: 0px;
    top: 0px;
    opacity: 0;
    filter: alpha(opacity=0);
    -ms-filter: alpha(opacity=0);
    cursor: pointer;
  }

</style>
{% endblock %}


{% block content %}

<div class="row">
  <div class="col-xl-12">
    <div class="card shadow mb-4">
      <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
        <h6 class="m-0 h3 text-gray-800">판매현황</h6>
      </div>
      <div class="card-body">
        <form method="POST" id="searchForm">
          <div class="row ml-3 mt-1">
            <span>
              <select class="form-control" id="center" name="center" onchange="btn_center(this.value)">
                <option value="">전체</option>
                {% for affiliate in affiliates %}
                <option value="{{ affiliate.affiliateId }}" {% if affiliateName == affiliate.affiliateId %} selected {% endif %}>
                  {{ affiliate.affiliateName }}
                </option>
                {% endfor %}
              </select>
            </span>
          </div>
        </form>
        <div class="row m-2 pt-3">
          <div class="col-xl-3">
            <div class="card border-left-primary shadow h-100 py-2">
              <div class="card-body">
                <div class="row no-gutters align-items-center">
                  <div class="col mr-2">
                    <div class="font-weight-bold text-primary text-uppercase mb-1">일간판매현황</div>
                    <div class="h5 mb-0 font-weight-bold text-gray-800"></div>
                  </div>
                  <div class="col-auto">
                    <i class="fas fa-coins fa-2x text-gray-300"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-xl-3">
            <div class="card border-left-success shadow h-100 py-2">
              <div class="card-body">
                <div class="row no-gutters align-items-center">
                  <div class="col mr-2">
                    <div class="font-weight-bold text-primary text-uppercase mb-1">주간판매현황</div>
                    <div class="h5 mb-0 font-weight-bold text-gray-800"></div>
                  </div>
                  <div class="col-auto">
                    <i class="fas fa-money-bill fa-2x text-gray-300"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-xl-3">
            <div class="card border-left-warning shadow h-100 py-2">
              <div class="card-body">
                <div class="row no-gutters align-items-center">
                  <div class="col mr-2">
                    <div class="font-weight-bold text-primary text-uppercase mb-1">월간판매현황</div>
                    <div class="h5 mb-0 font-weight-bold text-gray-800"></div>
                  </div>
                  <div class="col-auto">
                    <i class="fas fa-won-sign fa-2x text-gray-300"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-xl-3">
            <div class="card border-left-danger shadow h-100 py-2">
              <div class="card-body">
                <div class="row no-gutters align-items-center">
                  <div class="col mr-2">
                    <div class="font-weight-bold text-primary text-uppercase mb-1">연간판매현황</div>
                    <div class="h5 mb-0 font-weight-bold text-gray-800"></div>
                  </div>
                  <div class="col-auto">
                    <i class="fas fa-comment-dollar fa-2x text-gray-300"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <form method="POST" id="postForm">
          {% csrf_token %}
          <div class="form-group row m-2 pt-4">
            <div class="col-xl-2">
              <label for="saleDate" class="font-weight-bold text-primary"> 판매일자 </label> {{ form.saleDate }}
            </div>
            <div class="col-xl-2">
              <label for="affiliate" class="font-weight-bold text-primary"> 판매처 </label> {{ form.affiliate }}
            </div>
            <div class="col-xl-2">
              <label for="client" class="font-weight-bold text-primary"> 업체명
                {% if user.is_staff %}
                  <a class="text-white" target="_blank" href="/client/postclient/">
                    <i class="fas fa-plus-circle fa-fw text-info"></i>
                  </a>
                {% endif %}
              </label>
              {{ form.client }}
            </div>
            <div class="col-xl-1">
              <label for="product" class="font-weight-bold text-primary"> 모델명
                <!--{% if user.is_staff %}-->
                  <!--<a class="text-white" href="#" role="button" id="modelLink" data-toggle="modal" data-target="#modelModal">-->
                    <!--<i class="fas fa-plus-circle fa-fw text-info"></i>-->
                  <!--</a>-->
                <!--{% endif %}-->
              </label> {{ form.product }}
            </div>
            <div class="col-xl-1">
              <label for="size" class="font-weight-bold text-primary"> 사이즈 </label> {{ form.size }}
            </div>
            <div class="col-xl-1">
              <label for="unitPrice" class="font-weight-bold text-primary"> 단가 </label> {{ form.unitPrice }}
            </div>
            <div class="col-xl-1">
              <label for="quantity" class="font-weight-bold text-primary"> 수량 </label> {{ form.quantity }}
            </div>
            <div class="col-xl-1">
              <label for="salePrice" class="font-weight-bold text-primary"> 판매금액 </label> {{ form.salePrice }}
            </div>
            <div class="col-xl-1">
              <span class="btn bg-primary text-white mt-4 center" onclick="btn_post()">등록</span>
            </div>
          </div>
        </form>
        <div class="row m-3 center">
          {% if centers%}

          <table class="pc-table" style="width: 100%;">
            <tr style="background-color: #c5e4f8; color: black;">
              <th width="20%" class="font-weight-normal" style="background-color: #deeef8;">센터ID</th>
              <th width="70%" class="font-weight-normal">센터명</th>
              <th width="10%" class="font-weight-normal"><i class="fas fa-trash"></i></th>
            </tr>
            {% for center in centers %}
            <tr>
              <th width="20%" class="font-weight-normal text-dark" style="background-color: #deeef8;">{{ center.centerId }}</th>
              <th width="70%" class="font-weight-normal">{{ center.centerName }}</th>
              <th width="10%" class="font-weight-normal"><i class="fas fa-times-circle" id="{{ center.centerId }}" onclick="btn_delete(this)"></th>
            </tr>
            {% endfor %}
          </table>
          {% else %}
          <table class="pc-table m-2" style="width: 100%;">
            <tr style="background-color: #deeef8; color: black;">
              <td><span style="width:100%" class="text-center center mb-3"><span class="text-danger">판매 정보 없음</span></span></td>
            </tr>
          </table>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

<!--&lt;!&ndash; model Modal &ndash;&gt;-->
  <!--<div class="modal fade" id="modelModal" tabindex="-1" role="dialog" aria-labelledby="modelModalLabel" aria-hidden="true">-->
    <!--<div class="modal-dialog" role="document">-->
      <!--<div class="modal-content">-->

        <!--<div class="modal-header bg-info text-gray-100">-->
          <!--<h5 class="modal-title" id="categoryModalLabel">모델명 등록</h5>-->
          <!--<button class="close" type="button" data-dismiss="modal" aria-label="Close">-->
            <!--<span class="text-gray-100" aria-hidden="true">×</span>-->
          <!--</button>-->
        <!--</div>-->

        <!--<div class="modal-body">-->
          <!--<form id="categoryForm" action="/daesungwork/postmodel/" method="POST" onkeydown="javascript: if (event.keyCode == 13) {btn_category();}">-->
            <!--{% csrf_token %}-->
            <!--<div class="row mb-1">-->
              <!--<div class="col-6">-->
                <!--<label for="modelName" class="font-weight-bold text-primary">모델 명</label>-->
                <!--<input type="text" class="form-control" id="modelName" name="modelName" required>-->
              <!--</div>-->
              <!--<div class="col-6">-->
                <!--<label for="productName" class="font-weight-bold text-secondary">제품 명</label>-->
                <!--<input type="text" class="form-control" id="productName" name="modelName" required>-->
              <!--</div>-->
            <!--</div>-->
            <!--<div class="row mb-1">-->
              <!--<div class="col-6">-->
                <!--<label for="modelName" class="font-weight-bold text-primary">단가</label>-->
                <!--<input type="text" class="form-control" id="modelName" name="modelName" required>-->
              <!--</div>-->
              <!--<div class="col-6">-->
                <!--<label for="productName" class="font-weight-bold text-secondary">제품 사진</label>-->
                <!--<input type="text" class="form-control" id="productName" name="modelName" required>-->
              <!--</div>-->
            <!--</div>-->
          <!--</form>-->
        <!--</div>-->

        <!--<div class="modal-footer">-->
          <!--<button class="btn btn-secondary" type="button" data-dismiss="modal">취소</button>-->
          <!--<a class="btn btn-info" href="#" onclick="btn_category()">등록</a>-->
        <!--</div>-->
      <!--</div>-->
    <!--</div>-->
  <!--</div>-->

{% endblock %}


{% block script %}

<script type="text/javascript">
    function btn_delete(val) {
        const centerId = val.id;
        if (confirm("센터 정보를 삭제하시겠습니까?") == true) {
            const form = $('<form></form>');
            form.attr('action', '/daesungwork/deletecenter/');
            form.attr('method', 'POST');
            form.appendTo('body');

            const center = $('<input type="hidden" value="' + centerId + '" name="centerId">');
            form.append(center);
            form.submit();
        }
    }

    function replaceAll(str, searchStr, replaceStr) {
        if (str != null) {
            var new_str = str.split(searchStr).join(replaceStr);
            return new_str.split("T").join(" ").slice(0, 16);
        } else {
            return '-'
        }
    }

    function btn_change(centerName) {
        const searchForm = document.getElementById('searchForm');
        const searchDayInput = document.createElement("input");
        searchDayInput.setAttribute("type", "hidden");
        searchDayInput.setAttribute("name", "searchDay");
        searchDayInput.setAttribute("value", "{{ thisMonday |date:'Y-m-d'}}");
        searchForm.appendChild(searchDayInput);
        const centerNameInput = document.createElement("input");
        centerNameInput.setAttribute("type", "hidden");
        centerNameInput.setAttribute("name", "centerName");
        centerNameInput.setAttribute("value", centerName);
        searchForm.appendChild(centerNameInput);
        searchForm.submit();
    }

    function btn_post() {
        if (document.getElementById("centerName").value === '') {
            alert("센터명을 입력해주세요.");
            return false;
        }
        const postForm = document.getElementById('postForm');
        postForm.submit();

    }

    function btn_move(searchMonday) {
        if (searchMonday == 1) {
            const searchForm = document.getElementById("searchForm");
            const searchDayInput = document.createElement("input");
            searchDayInput.setAttribute("type", "hidden");
            searchDayInput.setAttribute("name", "searchDay");
            searchDayInput.setAttribute("value", "{{ lastMonday |date:'Y-m-d'}}");
            searchForm.appendChild(searchDayInput);
            const centerName = document.getElementById("centerName").value;
            const centerNameInput = document.createElement("input");
            centerNameInput.setAttribute("type", "hidden");
            centerNameInput.setAttribute("name", "centerName");
            centerNameInput.setAttribute("value", centerName);
            searchForm.appendChild(centerNameInput);

            searchForm.submit();


        } else {
            const searchForm = document.getElementById("searchForm");
            const searchDay = document.createElement("input");
            searchDay.setAttribute("type", "hidden");
            searchDay.setAttribute("name", "searchDay");
            searchDay.setAttribute("value", "{{ nextMonday |date:'Y-m-d'}}");
            searchForm.appendChild(searchDay);
            const centerName = document.getElementById("centerName").value;
            const centerNameInput = document.createElement("input");
            centerNameInput.setAttribute("type", "hidden");
            centerNameInput.setAttribute("name", "centerName");
            centerNameInput.setAttribute("value", centerName);
            searchForm.appendChild(centerNameInput);

            searchForm.submit();

        }

    }

    $(document).ready(function () {

    });


</script>

{% endblock %}